<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Devine le film ğŸ¬</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111111">

<script src="films.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<style>
body {
  background:#111;
  color:white;
  font-family:Arial, sans-serif;
  text-align:center;
  padding:20px;
  margin:0;
}
h1 {
  margin-top:20px;
}
#emojis {
  font-size:64px;
  margin:30px 0;
}
#answer {
  font-size:28px;
  color:#4CAF50;
  display:none;
  margin-bottom:20px;
}
#timer {
  font-size:32px;
  color:#ff5252;
  margin-bottom:25px;
}
button {
  width:80%;
  max-width:320px;
  font-size:18px;
  padding:15px;
  margin:8px auto;
  display:block;
  border:none;
  border-radius:12px;
  cursor:pointer;
}
button:active {
  transform:scale(0.97);
}
#qrcode {
  margin-top:20px;
}
</style>
</head>

<body>

<div style="
  margin-top:15px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
">
  <div style="margin-bottom:8px;">ğŸ“± Scanne pour les rÃ¨gles</div>
  <div id="qrcode"></div>
</div>

<h1>ğŸ¬ Devine le film</h1>

<div id="emojis">ğŸ¥â“</div>
<div id="answer">Clique sur Â« Question suivante Â»</div>
<div id="timer">â±ï¸ 30</div>

<button onclick="nextFilm()">ğŸ² Question suivante</button>
<button onclick="reveal()">ğŸ‘ï¸ RÃ©vÃ©ler</button>
<button onclick="startTimer()">â–¶ï¸ DÃ©marrer le chrono</button>
<button onclick="resetTimer()">ğŸ”„ Reset chrono</button>

<script>
/* === VARIABLES === */
let currentFilm = null;
let time = 30;
let timerInterval = null;

/* === QR CODE === */
new QRCode(document.getElementById("qrcode"), {
  text: window.location.href.split("?")[0] + "?mode=joueur",
  width:160,
  height:160
});

/* === FONCTIONS JEU === */
function nextFilm() {
  if (!films || films.length === 0) return;

  currentFilm = films[Math.floor(Math.random() * films.length)];

  document.getElementById("emojis").innerText = currentFilm.emojis;
  document.getElementById("answer").innerText = currentFilm.title;
  document.getElementById("answer").style.display = "none";

  resetTimer();
}

function reveal() {
  if (!currentFilm) return;
  document.getElementById("answer").style.display = "block";
}

/* === CHRONO === */
function startTimer() {
  clearInterval(timerInterval);
  time = 30;
  updateTimer();

  timerInterval = setInterval(() => {
    time--;
    updateTimer();

    if (time <= 0) {
      clearInterval(timerInterval);
      document.getElementById("timer").innerText = "â±ï¸ Temps Ã©coulÃ©";
    }
  }, 1000);
}

function resetTimer() {
  clearInterval(timerInterval);
  time = 30;
  updateTimer();
}

function updateTimer() {
  document.getElementById("timer").innerText = "â±ï¸ " + time;
}

const params = new URLSearchParams(window.location.search);
const isJoueur = params.get("mode") === "joueur";

if (isJoueur) {
  document.querySelectorAll("button").forEach(btn => btn.style.display = "none");
  document.getElementById("timer").style.display = "none";
  document.getElementById("answer").style.display = "none";
}
</script>

</body>
</html>
