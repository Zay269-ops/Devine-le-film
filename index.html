<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Devine le film â€“ Animateur ðŸŽ¬</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<style>
body {
  background:#111;
  color:white;
  font-family:Arial, sans-serif;
  text-align:center;
  margin:0;
  padding:20px;
}
.qr-wrapper {
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  margin-bottom:25px;
}
#qrcode {
  margin-top:8px;
}
#players {
  margin-top:20px;
}
.player {
  padding:6px;
  border-bottom:1px solid #333;
}
</style>
</head>

<body>

<h1>ðŸŽ¬ Devine le film â€“ Animateur</h1>

<div class="qr-wrapper">
  <div>ðŸ“± Scanne pour jouer</div>
  <div id="qrcode"></div>
</div>

<h2>ðŸ‘¥ Joueurs connectÃ©s</h2>
<div id="players">Aucun joueur</div>

<!-- Firebase DOIT Ãªtre chargÃ© AVANT le script jeu -->
<script type="module" src="firebase.js"></script>

<script type="module">
import { collection, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const db = window.db;

/* QR code vers joueurs.html (fiable GitHub Pages) */
new QRCode(document.getElementById("qrcode"), {
  text: new URL("joueurs.html", window.location.href).href,
  width:160,
  height:160
});

/* Affichage joueurs en temps rÃ©el */
const playersDiv = document.getElementById("players");

onSnapshot(collection(db, "players"), (snapshot) => {
  playersDiv.innerHTML = "";
  if (snapshot.empty) {
    playersDiv.innerText = "Aucun joueur";
    return;
  }
  snapshot.forEach(doc => {
    const p = doc.data();
    const div = document.createElement("div");
    div.className = "player";
    div.innerText = `${p.pseudo} â€” ${p.score} pts`;
    playersDiv.appendChild(div);
  });
});
</script>

</body>
</html>
